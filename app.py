import streamlit as st
import pandas as pd

# --- APP CONFIG (рд╣рд▓реНрдХрд╛ рдФрд░ рддреЗрдЬ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП) ---
st.set_page_config(page_title="Mishra Market Admin", layout="wide")

# --- DATA SETTING (рдЬреЛ рдЖрдкрдиреЗ рдлрд╛рдЗрдирд▓ рдХрд┐рдпрд╛ рдерд╛) ---
GOVT_UNIT = 792
GOVT_TOTAL_AMT = 5938.00
GOVT_EXTRA = 3979.06
KUL_GOVT_BILL = GOVT_TOTAL_AMT + GOVT_EXTRA # тВ╣9,917.06
LOSS_UNIT = 176
DUE_DATE = "07/02/2026"  # Column J рд╕реЗ

CURRENT_MONTH_BILL = 9934.24
TOTAL_PAYABLE = 48522.00

# --- SIDEBAR MENU ---
st.sidebar.title("ЁЯЫая╕П рдХрдВрдЯреНрд░реЛрд▓ рдкреИрдирд▓")
menu = ["ЁЯУК рдбреИрд╢рдмреЛрд░реНрдб", "ЁЯЦЛя╕П рд░реАрдбрд┐рдВрдЧ рдПрдВрдЯреНрд░реА", "ЁЯТ╕ рдкреЗрдореЗрдВрдЯ рд╡рд╕реВрд▓реА", "тЪЩя╕П рдордВрде рдХреНрд▓реЛрдЬ"]
choice = st.sidebar.radio("рдореЗрдиреБ рдЪреБрдиреЗрдВ", menu)

# --- 1. DASHBOARD (The King's View) ---
if choice == "ЁЯУК рдбреИрд╢рдмреЛрд░реНрдб":
    st.title("ЁЯСС рдорд┐рд╢реНрд░рд╛ рдорд╛рд░реНрдХреЗрдЯ - рдбрд┐рдЬрд┐рдЯрд▓ рдбреИрд╢рдмреЛрд░реНрдб")
    
    # рд╕рд░рдХрд╛рд░реА рд╕реЗрдХреНрд╢рди (GOVT_BILL_DATA)
    st.subheader("тЪб рд╕рд░рдХрд╛рд░реА рдмрд┐рд▓ рдПрд╡рдВ рдСрдбрд┐рдЯ")
    g1, g2, g3, g4, g5 = st.columns(5)
    g1.metric("Govt_Bill_Unit", f"{GOVT_UNIT}")
    g2.metric("Govt_Extra_Charges", f"тВ╣{GOVT_EXTRA}")
    g3.metric("рдХреБрд▓ рд╕рд░рдХрд╛рд░реА рд░рд╛рд╢рд┐", f"тВ╣{KUL_GOVT_BILL:.2f}")
    g4.metric("Loss (Chori)", f"{LOSS_UNIT} Units", delta="-Loss", delta_color="inverse")
    g5.metric("рдбреНрдпреВ рдбреЗрдЯ (Col J)", DUE_DATE)

    st.markdown("---")

    # рдорд╛рд░реНрдХреЗрдЯ рд░рд┐рдХрд╡рд░реА (SHOP_DATA)
    st.subheader("ЁЯПв рдорд╛рд░реНрдХреЗрдЯ рд░рд┐рдХрд╡рд░реА рд╕рд╛рд░рд╛рдВрд╢")
    s1, s2, s3 = st.columns(3)
    s1.metric("рдХреБрд▓ рдХрд░рдВрдЯ рдмрд┐рд▓", f"тВ╣{CURRENT_MONTH_BILL}")
    s2.metric("Total_Payable_Amount", f"тВ╣{TOTAL_PAYABLE}", delta="рдмрдХрд╛рдпрд╛ рд╕рд╣рд┐рдд")
    
    # Paid vs Pending (рд╡рд╕реВрд▓реА рдЧреНрд░рд╛рдл)
    paid_amt = 15000 # рдЙрджрд╛рд╣рд░рдг
    pending_amt = TOTAL_PAYABLE - paid_amt
    s3.metric("рдЕрднреА рднреА рдмрдХрд╛рдпрд╛", f"тВ╣{pending_amt}")
    
    st.progress(paid_amt / TOTAL_PAYABLE)
    st.write(f"рд╡рд╕реВрд▓реА рдкреНрд░реЛрдЧреНрд░реЗрд╕: {int((paid_amt/TOTAL_PAYABLE)*100)}%")

# --- 2. READING ENTRY ---
elif choice == "ЁЯЦЛя╕П рд░реАрдбрд┐рдВрдЧ рдПрдВрдЯреНрд░реА":
    st.header("ЁЯЦЛя╕П рдирдИ рд░реАрдбрд┐рдВрдЧ рдПрдВрдЯреНрд░реА")
    shop = st.selectbox("рджреБрдХрд╛рди рдЪреБрдиреЗрдВ", ["рдорд╛рдБ рджреБрд░реНрдЧрд╛", "рдкреВрдирдо рд▓реЗрдбрд┐рдЬ рдХреЙрд░реНрдирд░", "рдЖрдзреБрдирд┐рдХ рд╢реВрдЬ"])
    new_reading = st.number_input("Current_Reading рджрд░реНрдЬ рдХрд░реЗрдВ")
    if st.button("рд╡реНрд╣рд╛рдЯреНрд╕рдПрдк рдмрд┐рд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ"):
        st.success(f"{shop} рдХрд╛ рдмрд┐рд▓ рдЕрдкрдбреЗрдЯ рд╣реЛ рдЧрдпрд╛ рд╣реИред рд╡реНрд╣рд╛рдЯреНрд╕рдПрдк рд▓рд┐рдВрдХ рддреИрдпрд╛рд░ рд╣реИ!")

# --- 3. PAYMENT & RECEIPTS ---
elif choice == "ЁЯТ╕ рдкреЗрдореЗрдВрдЯ рд╡рд╕реВрд▓реА":
    st.header("ЁЯТ╕ рдкреЗрдореЗрдВрдЯ рд╡рд╕реВрд▓реА рдФрд░ рд░рд╕реАрдж")
    shop = st.selectbox("рджреБрдХрд╛рди рдЪреБрдиреЗрдВ", ["рдорд╛рдБ рджреБрд░реНрдЧрд╛", "рдкреВрдирдо рд▓реЗрдбрд┐рдЬ рдХреЙрд░реНрдирд░"])
    st.info(f"рдХреБрд▓ рд╡рд╕реВрд▓рдирд╛ рд╣реИ: тВ╣{TOTAL_PAYABLE} (рдмрдХрд╛рдпрд╛ рд╕рд╣рд┐рдд)")
    received = st.number_input("рдкреНрд░рд╛рдкреНрдд рд░рд╛рд╢рд┐")
    if st.button("рдкреЗрдореЗрдВрдЯ рд╕реЗрд╡ рдХрд░реЗрдВ"):
        st.success("рдкреЗрдореЗрдВрдЯ рджрд░реНрдЬ! рдмрдХрд╛рдпрд╛ рдЕрдЧрд▓реЗ рдорд╣реАрдиреЗ рдХреИрд░реА рдлреЙрд░рд╡рд░реНрдб рд╣реЛ рдЬрд╛рдПрдЧрд╛ред")

# --- 4. MONTH CLOSE ---
elif choice == "тЪЩя╕П рдордВрде рдХреНрд▓реЛрдЬ":
    st.header("тЪЩя╕П рдорд╣реАрдирд╛ рдмрдВрдж рдХрд░реЗрдВ (Carry Forward)")
    st.error("рд╕рд╛рд╡рдзрд╛рди: рдпрд╣ рдмрдЯрди рджрдмрд╛рддреЗ рд╣реА рд╕рд╛рд░рд╛ рдбреЗрдЯрд╛ Row 11 рдХреЗ рдиреАрдЪреЗ рд╕реЗрд╡ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред")
    if st.button("рдХрдВрдлрд░реНрдо рдХреНрд▓реЛрдЬ рдордВрде"):
        st.balloons()
        st.success("рдЗрддрд┐рд╣рд╛рд╕ рд╕реБрд░рдХреНрд╖рд┐рдд! рдЕрдм рдирдпрд╛ рдорд╣реАрдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВред")
